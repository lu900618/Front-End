angular.module("movieCat",["ui.router","route","serviceModule","inTheatersModule","commingSoonModule","topModule","searchModule"]).controller("navBarCtrl",["$scope","$location",function(e,o){e.search=function(){o.path("/search/1/"+e.keyword),e.keyword=""}}]),angular.module("route",[]).config(["$stateProvider","$urlRouterProvider",function(e,o){e.state({url:"/in_theaters/:page",templateUrl:"./views/in_theaters/in_theaters.html",name:"in_theaters",controller:"inTheatersCtrl"}).state({url:"/comming_soon/:page",templateUrl:"./views/comming_soon/comming_soon.html",name:"comming_soon",controller:"commingSoonCtrl"}).state({url:"/top250/:page",templateUrl:"./views/top250/top250.html",name:"top250",controller:"topCtrl"}).state({url:"/search/:page/:keyword",templateUrl:"./views/search/search.html",name:"search",controller:"searchCtrl"}),o.otherwise("/in_theaters/1")}]),angular.module("serviceModule",[]).service("myService",[function(){this.myJsonp=function(e,o,t){var a="myJsonp_"+Math.random().toString().replace(".","");window[a]=t;var n="";for(var r in o)n+=r+"="+o[r]+"&";var l=document.createElement("script");l.src=e+"?"+n+"callback="+a,l.onload=function(){document.body.removeChild(l)},document.body.appendChild(l)}}]),angular.module("commingSoonModule",[]).controller("commingSoonCtrl",["$scope","$http","myService","$stateParams","$location",function(e,o,t,a,n){var r=a.page,l=10*(r-1),c=0;t.myJsonp("https://api.douban.com/v2/movie/coming_soon",{count:10,start:l},function(o){console.log(o),e.result=o,c=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"===e?++r>c&&(r=c):"prev"===e&&--r<1&&(r=1),n.path("/comming_soon/"+r)}}]),angular.module("inTheatersModule",[]).controller("inTheatersCtrl",["$scope","$http","myService","$stateParams","$location",function(e,o,t,a,n){var r=a.page,l=10*(r-1),c=0;t.myJsonp("https://api.douban.com/v2/movie/in_theaters",{count:10,start:l},function(o){console.log(o),e.result=o,c=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"===e?++r>c&&(r=c):"prev"===e&&--r<1&&(r=1),n.path("/in_theaters/"+r)}}]),angular.module("searchModule",[]).controller("searchCtrl",["$scope","$http","myService","$stateParams","$location",function(e,o,t,a,n){var r=a.keyword,l=a.page,c=10*(l-1),i=0;t.myJsonp("https://api.douban.com/v2/movie/search",{q:r,count:10,start:c},function(o){console.log(o),e.result=o,i=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"===e?++l>i&&(l=i):"prev"===e&&--l<1&&(l=1),n.path("/search/"+l+"/"+r)}}]),angular.module("topModule",[]).controller("topCtrl",["$scope","$http","myService","$stateParams","$location",function(e,o,t,a,n){var r=a.page,l=10*(r-1),c=0;t.myJsonp("https://api.douban.com/v2/movie/top250",{count:10,start:l},function(o){console.log(o),e.result=o,c=Math.ceil(o.total/10),e.$apply()}),e.changePage=function(e){"next"===e?++r>c&&(r=c):"prev"===e&&--r<1&&(r=1),n.path("/top250/"+r)}}]);